<?phpfunction gibtabelle ($tabelle, $mannschaften, $wettkampfid){	include ("SCRIPTstyles.php");		$textstyle = fontType("black");		include ("SCRIPTconnect.php");	    $uid = $_SESSION['uid'];    $langsuffix = Whichlanguage($db, $uid);    include ("../languages/" . $langsuffix . "/tabelleBundesliga." . $langsuffix);		echo "<TABLE cellspacing=\"1\" $bgcolor35 $border0 $center>";	echo "<tr><th $cspn10 $center><font size=4>$lang_f_tableofteams</TH></TR>";	echo "<TR>";	echo "<TH>$textstyle &nbsp; $lang_f_team &nbsp;</TH>";	echo "<TH>$textstyle &nbsp;$lang_f_matches &nbsp;</TH>";	echo "<TH $cspn3>$textstyle &nbsp; " . $lang_f_won . " &nbsp;&nbsp;  &nbsp;&nbsp; " . $lang_f_deuce . " &nbsp;&nbsp;  &nbsp;&nbsp; " . $lang_f_lost ." &nbsp;&nbsp;</TH>";	echo "<TH $cspn3>$textstyle &nbsp;" . $lang_f_goals . " &nbsp;</TH>";	echo "<TH>$textstyle &nbsp;" . $lang_f_diff . " &nbsp;</TH>";	echo "<TH>$textstyle &nbsp;" . $lang_f_points . " &nbsp;</TH>";	echo "</TR>";	$i = 1;	foreach($mannschaften as $m)	{		switch ($i)		{			case $i <= 3:				$bgcolor = $bgcolor36;				break;			case $i > 15:				$bgcolor = $bgcolor39;				break;		}		if (!$tabelle["$m"]["win"]) $tabelle["$m"]["win"] = "-";		if (!$tabelle["$m"]["duce"]) $tabelle["$m"]["duce"] = "-";		if (!$tabelle["$m"]["lose"]) $tabelle["$m"]["lose"] = "-";					echo "<TR $bgcolor>";		echo "<TD $center>";				echo "<table width=\"100%\" border=\"0\"><tr>";				echo "<td width=\"35\">$textstyle " . $i . ".</b></td>";				echo "<td $center $top width=\"28\">";				echo "<img src=\"../img/Wappen/";			include ("SCRIPTconnect.php"); #global $db;						$spruch  = "SELECT wappen_src FROM team";			$spruch .= " WHERE team.name = '$m'";			$result = mysql_query( $spruch, $db ) or die("Query failed : " . mysql_error());			$row = mysql_fetch_array($result, MYSQL_ASSOC);										echo $row['wappen_src'];							echo "\" alt=\"$m\" height=\"15\">";				echo "</td><td $left>";                $lteam = TeamLanguage($m);				echo "<TD>$textstyle &nbsp; $lteam  &nbsp;</TD>";				echo "</td></tr></table>";		echo "</TD>";		echo "<TD $center>";		echo "$textstyle &nbsp;" . $tabelle["$m"]["spiel"] . " &nbsp;</TD>";		echo "<TD $center>$textstyle &nbsp;" . $tabelle["$m"]["win"] . " &nbsp;</TD>";		echo "<TD $center>$textstyle &nbsp;" . $tabelle["$m"]["duce"] . " &nbsp;</TD>";		echo "<TD $center>$textstyle &nbsp;" . $tabelle["$m"]["lose"] . " &nbsp;</TD>";		echo "<TD $center>$textstyle" . $tabelle["$m"]["raus"] . "</TD>";		echo "<TD $center>:</TD>";		echo "<TD $center>$textstyle" . $tabelle["$m"]["rein"] . "</TD>";		$diff = $tabelle["$m"]["raus"] - $tabelle["$m"]["rein"];		echo "<TD $center>$textstyle &nbsp;" . $diff . " &nbsp;</TD>";		echo "<TD $center>$textstyle &nbsp;" . $tabelle["$m"]["punkte"] . " &nbsp;</TD>";		echo "</TR>";		$bgcolor = $bgcolor38;		$i++;	}		echo "<tr><td $cspn10>&nbsp;</td></tr>"; // Freie Zeile in Tabelle		//############# penaltys anzeigen #####################	$textstyle = fontType("black");	echo "<tr><td $cspn10>&nbsp;$textstyle";	echo $lang_f_penalty . ":";	echo "&nbsp;";	echo "</td></tr>";	include ("SCRIPTconnect.php");	$sprich  = "SELECT penalty.team_id, penalty, warum, team.name";$sprich .= " FROM penalty";$sprich .= " INNER JOIN team ON penalty.team_id = team.id";$sprich .= " WHERE wettkampf_id = $wettkampfid";$resilt = mysql_query( $sprich, $db ) or die("Query failed : " . mysql_error());	while ($riw = mysql_fetch_array($resilt, MYSQL_ASSOC))		{			echo "<tr>";		$textstyle = fontType($txtcol9);		echo "<td>&nbsp;$textstyle";		$lteam = TeamLanguage($riw['name']);		echo $lteam;		echo "&nbsp;</td>";				$textstyle = fontType("red");		echo "<td>&nbsp;$textstyle";		echo $riw['penalty'];		echo "&nbsp;</td>";					$textstyle = fontType("black");		echo "<td $cspn8>&nbsp;$textstyle";		echo $riw['warum'];		echo "&nbsp;</td>";						echo "</tr>";		}//################################################		echo "</TABLE>";}function TabelleAusSpiel($spieltag, $result, $tabelle){    include ("SCRIPTconnect.php");	#global $db;	#global $tabelle;		$heim = array();	$gast = array();	$heim_id = array();	$gast_id = array();	$tore_heim = array();	$tore_gast = array();	$spieltag = array();	while ($row = mysql_fetch_array($result, MYSQL_ASSOC))	{//		echo $row['heim'] . " : " . $row['gast'];//		echo $row['tore_heim'] . " : " . $row['tore_gast'] . "<BR>";		$heim[] = $row['heim'];		$gast[] = $row['gast'];		$heim_id[] = $row['heim_team_id'];		$gast_id[] = $row['gast_team_id'];		$tore_heim[] = $row['tore_heim'];		$tore_gast[] = $row['tore_gast'];		$spieltag[] = $row['spieltag'];	}	for ($i=0;$i<count($heim);$i++)	{		if ( $tore_heim[$i] == "" || $tore_gast[$i] == "" ) continue;		$tabelle["${heim[$i]}"]["id"] = $heim_id[$i];		$tabelle["${gast[$i]}"]["id"] = $gast_id[$i];		$tabelle["${heim[$i]}"]["spiel"] = $spieltag[$i];		$tabelle["${gast[$i]}"]["spiel"] = $spieltag[$i];				if ($tore_heim[$i] > $tore_gast[$i])		{			// Punkte			$tabelle["${heim[$i]}"]["punkte"] = $tabelle["${heim[$i]}"]["punkte"] + 3;			$tabelle["${gast[$i]}"]["punkte"] = $tabelle["${gast[$i]}"]["punkte"] + 0;			// Tore geschossen			$tabelle["${heim[$i]}"]["raus"] = $tabelle["${heim[$i]}"]["raus"] + $tore_heim[$i];			$tabelle["${gast[$i]}"]["raus"] = $tabelle["${gast[$i]}"]["raus"] + $tore_gast[$i];			// Tore gekriegt			$tabelle["${heim[$i]}"]["rein"] = $tabelle["${heim[$i]}"]["rein"] + $tore_gast[$i];			$tabelle["${gast[$i]}"]["rein"] = $tabelle["${gast[$i]}"]["rein"] + $tore_heim[$i];			// Spiele gewonenn			$tabelle["${heim[$i]}"]["win"] = $tabelle["${heim[$i]}"]["win"] + 1;			// spiele verloren			$tabelle["${gast[$i]}"]["lose"] = $tabelle["${gast[$i]}"]["lose"] + 1;		}		if ($tore_heim[$i] == $tore_gast[$i])		{			$tabelle["${heim[$i]}"]["punkte"] = $tabelle["${heim[$i]}"]["punkte"] + 1;			$tabelle["${gast[$i]}"]["punkte"] = $tabelle["${gast[$i]}"]["punkte"] + 1;			$tabelle["${heim[$i]}"]["raus"] = $tabelle["${heim[$i]}"]["raus"] + $tore_heim[$i];			$tabelle["${gast[$i]}"]["raus"] = $tabelle["${gast[$i]}"]["raus"] + $tore_gast[$i];			$tabelle["${heim[$i]}"]["rein"] = $tabelle["${heim[$i]}"]["rein"] + $tore_gast[$i];			$tabelle["${gast[$i]}"]["rein"] = $tabelle["${gast[$i]}"]["rein"] + $tore_heim[$i];			// Spiele unentschieden			$tabelle["${heim[$i]}"]["duce"] = $tabelle["${heim[$i]}"]["duce"] + 1;			$tabelle["${gast[$i]}"]["duce"] = $tabelle["${gast[$i]}"]["duce"] + 1;		}		if ($tore_heim[$i] < $tore_gast[$i])		{			$tabelle["${heim[$i]}"]["punkte"] = $tabelle["${heim[$i]}"]["punkte"] + 0;			$tabelle["${gast[$i]}"]["punkte"] = $tabelle["${gast[$i]}"]["punkte"] + 3;			$tabelle["${heim[$i]}"]["raus"] = $tabelle["${heim[$i]}"]["raus"] + $tore_heim[$i];			$tabelle["${gast[$i]}"]["raus"] = $tabelle["${gast[$i]}"]["raus"] + $tore_gast[$i];			$tabelle["${heim[$i]}"]["rein"] = $tabelle["${heim[$i]}"]["rein"] + $tore_gast[$i];			$tabelle["${gast[$i]}"]["rein"] = $tabelle["${gast[$i]}"]["rein"] + $tore_heim[$i];			$tabelle["${heim[$i]}"]["lose"] = $tabelle["${heim[$i]}"]["lose"] + 1;			$tabelle["${gast[$i]}"]["win"] = $tabelle["${gast[$i]}"]["win"] + 1;		}	}return $tabelle;}include("SCRIPTconnect.php");// +++++++  gesamtpenalty von mannschaften ++++++++++++++$penalty = array();$spruch  = "SELECT penalty.team_id, SUM(penalty) AS gesamtpenalty, team.name AS teamname";$spruch .= " FROM penalty";$spruch .= " INNER JOIN team ON penalty.team_id = team.id";$spruch .= " WHERE wettkampf_id = $wettkampfid";$spruch .= " GROUP BY penalty.team_id";$spruch .= " ORDER BY gesamtpenalty DESC";$result = mysql_query( $spruch, $db ) or die("Query failed : " . mysql_error());	while ($row = mysql_fetch_array($result, MYSQL_ASSOC))	{		$a = $row['teamname'];		$penalty["$a"] = $row['gesamtpenalty'];	}	//  +++++++++++++++++++++++++++++++++++++++++++++++++++++$tabelle = array();if (!$spieltag) $spieltag = 1;	$spruch = "SELECT liga_spiel.id, spieltag, heim_team_id, gast_team_id, tore_heim, tore_gast,";	$spruch .= " team.name AS heim, team2.name AS gast";	$spruch .= " FROM liga_spiel";	$spruch .= " LEFT JOIN team ON liga_spiel.heim_team_id = team.id";	$spruch .= " LEFT JOIN team AS team2 ON liga_spiel.gast_team_id = team2.id";	$spruch .= " WHERE wettkampf_id = $wettkampfid AND spieltag <= $spieltag"; #AND done != 1	$spruch .= " ORDER BY spieltag ASC";		$result = mysql_query($spruch, $db);$tabelle = TabelleAusSpiel($spieltag, $result, $tabelle);$mannschaften = array();$mannschaften = array_keys($tabelle);$punkte = array();$tore_raus = array();$tore_rein = array();$diff = array();//echo "<TABLE BORDER=\"1\"><TR><TD>";//gibtabelle($tabelle, $mannschaften);//echo "</TD>";//echo "<TD>"; foreach ($mannschaften as $m){	if ($penalty["$m"])	{		$tabelle["$m"]["punkte"] = $tabelle["$m"]["punkte"] - $penalty["$m"];	}	$punkte[] = $tabelle["$m"]["punkte"];	$tore_raus[] = $tabelle["$m"]["raus"];	$tore_rein[] = $tabelle["$m"]["rein"];	$diff[] = $tabelle["$m"]["raus"] - $tabelle["$m"]["rein"];}array_multisort ($punkte, SORT_DESC, SORT_NUMERIC, $diff, SORT_DESC, SORT_NUMERIC, $tore_raus, SORT_DESC, SORT_NUMERIC, $mannschaften);gibtabelle($tabelle, $mannschaften, $wettkampfid);?>